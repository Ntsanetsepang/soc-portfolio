# Incident Report: Phishing Campaign Leading to Data Exfiltration

**Incident ID**: IR-2023-0315  
**Date**: March 15, 2023  
**Classification**: Confirmed Data Breach  
**Status**: Closed  
**Prepared by**: [Your Name]  

## Executive Summary

On March 15, 2023, the security team detected suspicious network traffic originating from a workstation in the Finance department. Investigation revealed that an employee had fallen victim to a targeted phishing attack, resulting in the installation of a remote access trojan (RAT). The threat actor used this foothold to move laterally within the network, access sensitive financial data, and exfiltrate approximately 2.3 GB of data to an external command and control (C2) server. The incident was contained within 6 hours of detection, and all compromised accounts and systems were remediated.

## Incident Timeline

| Date/Time (UTC) | Event | Details |
|-----------------|-------|--------|
| 2023-03-15 08:23 | Initial Compromise | Employee received and opened a phishing email with a malicious Excel attachment |
| 2023-03-15 08:25 | Malware Execution | Excel macro executed, downloading and installing a RAT from a remote server |
| 2023-03-15 08:30 | C2 Established | RAT established connection with C2 server at 203.0.113.45 |
| 2023-03-15 09:15 | Credential Harvesting | Attacker used Mimikatz to extract credentials from memory |
| 2023-03-15 10:22 | Lateral Movement | Attacker used harvested credentials to access file server |
| 2023-03-15 11:45 | Data Discovery | Attacker accessed financial documents and customer database |
| 2023-03-15 12:30 | Data Exfiltration | 2.3 GB of data exfiltrated via encrypted channel to C2 server |
| 2023-03-15 14:15 | Detection | Security monitoring detected unusual data transfer patterns |
| 2023-03-15 14:20 | Alert Triage | SOC analyst confirmed suspicious activity and escalated incident |
| 2023-03-15 14:45 | Containment Initiated | Affected workstation isolated from network |
| 2023-03-15 15:30 | Forensic Acquisition | Memory and disk images acquired from compromised system |
| 2023-03-15 16:30 | Credential Reset | All potentially compromised credentials reset |
| 2023-03-15 18:00 | Network Blocks | Firewall rules updated to block C2 infrastructure |
| 2023-03-15 20:15 | Containment Complete | All affected systems isolated and secured |
| 2023-03-16 09:00 | Eradication | Malware removed, systems rebuilt from clean images |
| 2023-03-17 14:00 | Recovery | Systems returned to production with enhanced monitoring |
| 2023-03-20 16:00 | Incident Closed | Final report completed, lessons learned documented |

## Technical Details

### Attack Vector

The initial infection vector was a spear-phishing email targeting a finance department employee. The email purported to be from a trusted vendor and contained an Excel attachment named `Invoice_March2023.xlsm`. When opened, the document prompted the user to enable macros, which then executed a PowerShell script that downloaded and installed the RAT.

### Malware Analysis

The RAT was identified as a variant of Meterpreter with the following characteristics:

- SHA256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
- C2 Protocol: HTTPS over port 443
- C2 Servers: 203.0.113.45, 198.51.100.72
- Persistence Mechanism: Scheduled task and registry run key
- Anti-Analysis Features: VM detection, sleep timers, encrypted strings

The malware established persistence through two mechanisms:

1. A scheduled task named "WindowsUpdateCheck" running every 30 minutes
2. A registry key at `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\UpdateService`

### Lateral Movement

The attacker used the following techniques for lateral movement:

1. Credential harvesting using Mimikatz
2. Pass-the-hash attacks
3. WMI and PowerShell remoting
4. RDP connections to compromised hosts

### Data Exfiltration

Data was exfiltrated using an encrypted HTTPS channel to the C2 server. The exfiltrated data included:

- Financial spreadsheets
- Customer information
- Internal strategy documents
- Employee personal information

## Impact Assessment

### Affected Systems

- 1 Finance department workstation (primary compromise)
- 1 File server (secondary compromise)
- 3 User accounts compromised

### Data Breach Scope

- Approximately 2.3 GB of data exfiltrated
- Estimated 5,000 customer records potentially exposed
- Financial data from Q1 2023 accessed

### Operational Impact

- Finance department operations disrupted for 24 hours
- IT staff diverted to incident response for 3 days
- Temporary restrictions on external file sharing implemented

## Remediation Actions

### Containment

1. Isolated compromised workstation from network
2. Blocked C2 infrastructure at firewall and DNS levels
3. Reset all potentially compromised credentials
4. Implemented temporary network segmentation for finance department

### Eradication

1. Reimaged compromised workstation
2. Removed malicious scheduled tasks and registry entries
3. Scanned all systems for indicators of compromise
4. Updated antivirus signatures and EDR rules

### Recovery

1. Restored systems from clean backups
2. Implemented enhanced monitoring for affected systems
3. Gradually restored network connectivity with additional controls
4. Verified integrity of financial data

## Root Cause Analysis

The root causes of this incident were identified as:

1. **Technical Vulnerabilities**:
   - Macro execution allowed in Microsoft Office
   - Insufficient application whitelisting
   - Delayed security patches on affected workstation

2. **Process Deficiencies**:
   - Inadequate email filtering for malicious attachments
   - Insufficient user security awareness training
   - Delayed alert triage process

3. **Architectural Weaknesses**:
   - Excessive lateral movement paths within the network
   - Insufficient network segmentation
   - Inadequate data loss prevention controls

## Recommendations

### Short-term (0-30 days)

1. Disable macro execution in Office documents from external sources
2. Implement additional email filtering rules for high-risk attachments
3. Conduct targeted security awareness training for finance department
4. Enhance monitoring for PowerShell execution and suspicious network connections
5. Implement additional network segmentation for sensitive departments

### Medium-term (30-90 days)

1. Deploy application whitelisting across all workstations
2. Implement privileged access management solution
3. Enhance data loss prevention controls
4. Review and improve security monitoring and alerting procedures
5. Conduct a comprehensive review of Active Directory security

### Long-term (90+ days)

1. Implement a zero-trust architecture
2. Enhance security automation and orchestration capabilities
3. Develop an advanced threat hunting program
4. Implement enhanced endpoint protection across the organization
5. Conduct regular red team exercises to test defenses

## Lessons Learned

1. Early detection is critical - the time between compromise and detection allowed the attacker to achieve their objectives
2. Phishing remains an effective initial access vector despite awareness programs
3. Basic security controls (macro disabling, application whitelisting) could have prevented this incident
4. Network segmentation is essential to limit lateral movement
5. Regular security awareness training needs to be supplemented with targeted exercises

## Appendices

### Appendix A: Indicators of Compromise (IOCs)

**IP Addresses**:
- 203.0.113.45 (C2 Server)
- 198.51.100.72 (Backup C2 Server)

**Domains**:
- update-service[.]com
- cdn-storage[.]net
- secure-download[.]org

**File Hashes**:
- e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 (RAT)
- a1e0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 (Excel Document)
- b2d0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 (PowerShell Loader)

**Registry Keys**:
- HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\UpdateService
- HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SystemService

**Scheduled Tasks**:
- WindowsUpdateCheck
- SystemServiceManager

### Appendix B: MITRE ATT&CK Mapping

| Tactic | Technique | Description |
|--------|-----------|-------------|
| Initial Access | T1566.001 | Spear Phishing Attachment |
| Execution | T1204.002 | User Execution: Malicious File |
| Execution | T1059.001 | Command and Scripting Interpreter: PowerShell |
| Persistence | T1053.005 | Scheduled Task/Job: Scheduled Task |
| Persistence | T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys |
| Privilege Escalation | T1055 | Process Injection |
| Defense Evasion | T1140 | Deobfuscate/Decode Files or Information |
| Credential Access | T1003.001 | OS Credential Dumping: LSASS Memory |
| Discovery | T1083 | File and Directory Discovery |
| Lateral Movement | T1021.001 | Remote Services: Remote Desktop Protocol |
| Collection | T1560 | Archive Collected Data |
| Command and Control | T1071.001 | Application Layer Protocol: Web Protocols |
| Exfiltration | T1048 | Exfiltration Over Alternative Protocol |

### Appendix C: Investigation Team

- [Your Name], Lead Investigator
- [Team Member 1], Forensic Analyst
- [Team Member 2], Network Security Analyst
- [Team Member 3], Malware Analyst
- [Team Member 4], Incident Response Coordinator